# A Generic Methodology for the Modular Verification of Security Protocol Implementations

[![Reusable Verification Library](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/library.yml/badge.svg?branch=main)](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/library.yml?query=branch%3Amain)
[![Reusable Verification Library for VeriFast](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/verifast-library.yml/badge.svg?branch=main)](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/verifast-library.yml?query=branch%3Amain)
[![NSL Case Study](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/nsl.yml/badge.svg?branch=main)](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/nsl.yml?query=branch%3Amain)
[![DH Case Study](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/dh.yml/badge.svg?branch=main)](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/dh.yml?query=branch%3Amain)
[![WireGuard Case Study](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/wireguard.yml/badge.svg?branch=main)](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/wireguard.yml?query=branch%3Amain)
[![NSL Case Study for VeriFast](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/verifast-nsl.yml/badge.svg?branch=main)](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/verifast-nsl.yml?query=branch%3Amain)
[![Verification of DY* Examples](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/dy.yml/badge.svg?branch=main)](https://github.com/ModularVerification/SecurityProtocolImplementations/actions/workflows/dy.yml?query=branch%3Amain)

## Structure
- `ReusableVerificationLibrary` contains the Gobra sources that constitute the Reusable Verification Library
- `casestudies/nsl` contains the sources of the NSL case study. The implementation consists of separate packages for the initiator, initiator2 (using a slightly different code structure), and responder role. The main package sets up communication via Go channels and executes the two protocol roles as threads (using Goroutines)
- `casestudies/dh` contains the sources of the DH case study, which follows a similar structure as the NSL case study and consists of packages for the initiator and responder roles.
- `casestudies/wireguard` contains the sources of the WireGuard case study. The role implementations are mainly located in the `initiator` and `responder` packages. The trace invariants are defined in `verification/common` and `verification/labellemma` contains the WireGuard-specific lemmas and their proofs.
- `VeriFastPrototype` contains the C sources of our prototype for VeriFast. The prototype demonstrates that (1) a concurrent data structure can be built on top of VeriFast's built-in mutex offering the same local snapshots as our Reusable Verification Library, (2) a parameterized trace invariant in the form of a separation logic predicate can be defined, and (3) several lemmas, such as the uniqueness of events or the secrecy lemma, can be proven using the trace invariant. Furthermore, implementations in C of the NSL initiator & responder demonstrate that we can instantiate and use the Reusable Verification Library for VeriFast to prove secrecy and injective agreement, i.e., the same security properties as for the implementation in Go using Gobra.
- `dy-star` contains two examples for the DY* verification framework illustrating that violations of DY*'s implicit code structure assumptions result in unsound reasoning in DY*. Existing implementations may have arbitrary code structure and, therefore, may violate DY*â€™s implicit assumptions. Each example contains a README detailing what properties we can prove and how to verify the example using DY*.
